---
import { getEntry } from 'astro:content';
import BlogPost from '../../layouts/BlogPost.astro';

// Get the slug from the URL (it's a catch-all route, so join if array)
const slugParam = Astro.params.slug;
const slug = Array.isArray(slugParam) ? slugParam.join('/') : slugParam;

// Fetch the post dynamically (SSR mode)
const post = await getEntry('blog', slug as string);

// 404 if post doesn't exist
if (!post) {
  return Astro.redirect('/404');
}

const { Content } = await post.render();
---

<BlogPost {...post.data} slug={post.slug}>
  <Content />
</BlogPost>

